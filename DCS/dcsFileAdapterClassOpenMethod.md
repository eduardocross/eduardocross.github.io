---
title: FileAdapter.Open Method

Id: dcsFileAdapterClassOpenMethod
TocParent: dcsFileAdapterMethods
TocOrder: 13

keywords: FileAdapter.Open method
keywords: Open method
keywords: open existing file
keywords: files, open existing
keywords: database files, open existing
keywords: how to, open existing database files

---

Open a database file for access with the specified [AdgDataSet](dcsAdgDataSetClass.html).
<pre>
        <span class="lang">[C#]</span>
 **Public void Open(
   [AdgDataSet](dcsAdgDataSetClass.html) ds
);** 
      </pre>
      <pre>
        <span class="lang">[Visual Basic] </span>
 **Public Sub Open( _
   ByVal ds As [AdgDataSet](dcsAdgDataSetClass.html) _
)** 
      </pre>
      <pre class="prettyprint">
        <span class="lang">[Visual RPG]</span>
 **BegSr Open Access(*Public)
   DclSrParm ds Type([AdgDataSet](dcsAdgDataSetClass.html))** 
      </pre>

Parameters

<dl>
        <dt>
 *ds* 
        </dt>
        <dd>The DataSet object **(AdgDataSet** ) with which a file will be 
						opened.
					</dd>
</dl>

Exceptions

ASNA.DataGate.Common.dgException is thrown to signal normal procedural conditions, in addition to error conditions. The following table summarizes these conditions, and the corresponding value of the dgException.Error property.
<br />

<table class="dtTABLE" id="Table5" x-use-null-cells="x-use-null-cells" style="border-spacing: 0px;     x-cell-content-align: Top" cellspacing="0">
          <colgroup span="1">
            <col span="1" style="FONT-WEIGHT: bold; WIDTH: 20%" />
            <col span="1" style="WIDTH: 70%" />
          </colgroup>
          <tr>
            <th colspan="1" rowspan="1">
							Value of dgException.Error
						</th>
            <th colspan="1" rowspan="1">
							Condition
						</th>
          </tr>
          <tr>
            <td colspan="1" rowspan="1">

dgEOLDSERVER
</td>
            <td colspan="1" rowspan="1">

The file cannot be opened because the operation is not supported by the version of the database provider of the [AdgConnection](dcsAdgConnectionClass.html) object.
</td>
          </tr>
          <tr>
            <td colspan="1" rowspan="1">

dgEINVARG
</td>
            <td colspan="1" rowspan="1">

The [FileName](dcsFileAdapterClassFileNameProperty.html) or [ MemberName](dcsFileAdapterClassMemberNameProperty.html) properties refer to an invalid database file name.
</td>
          </tr>
          <tr>
            <td colspan="1" rowspan="1">

dgEaINVDMOP
</td>
            <td colspan="1" rowspan="1">

The operation is not allowed because the database is opened for monitor access only.
</td>
          </tr>
          <tr>
            <td colspan="1" rowspan="1">

dgEsAS400ERROR
</td>
            <td colspan="1" rowspan="1">

The database server encountered a system error. Details may be available via the SystemError and Text fields of dgException.
</td>
          </tr>
          <tr>
            <td colspan="1" rowspan="1">

dgEaBADFRMTID
</td>
            <td colspan="1" rowspan="1">

A "level check" operation was requested and the check discovered a difference between an expected format and the actual format of the file.
</td>
          </tr>
          <tr>
            <td colspan="1" rowspan="1">

dgExDENIED
</td>
            <td colspan="1" rowspan="1">

The database provider called an "exit point" program to validate the operation and the program denied the requested operation.
</td>
          </tr>
          <tr>
            <td colspan="1" rowspan="1">

dgExINVLIC
</td>
            <td colspan="1" rowspan="1">

The database provider has found a registration for an "exit point" program to validate the operation but the database provider is not currently licensed for that capability.
</td>
          </tr>
          <tr>
            <td colspan="1" rowspan="1">

dgExMISSING
</td>
            <td colspan="1" rowspan="1">

The database provider has found a registration for an "exit point" program to validate the operation, but no such program could be found.
</td>
          </tr>
</table>

Remarks

**Open** , [OpenNewAdgDataSet](dcsFileAdapterClassOpenNewAdgDataSetMethod.html), and [OpenSimpleQuery](dcsFileAdapterClassOpenSimpleQueryMethod.html) are the three methods available for opening database files with [ FileAdapter](dcsFileAdapterClass.html)<a>. </a>

**Open** is designed for use with development environments capable of independently creating **AdgDataSet** instances. The method is passed an instance of **AdgDataSet** which is presumed to match the database file being opened. For example, **Open** is used by code generated by Visual RPG. This development environment creates strongly-typed **AdgDataSet** classes at compile-time which enhance the programâ€™s access capability. Application developers however, can open files as effectively and easily using the **OpenNewAdgDataSet** method.

**Open** and **OpenNewAdgDataSet** observe the current value of the [AccessMode](dcsFileAdapterClassAccessModeProperty.html) property. This property specifies how access to the file is enforced by the database. For example, to allow records to be deleted by the **FileAdapter** , use a value for **AccessMode** that includes the [ AccessMode.Delete](dcsAccessModeEnumeration.html) flag.

**Open** and **OpenNewAdgDataSet** also observe the [ OpenAttributes](dcsFileAdapterClassOpenAttributesProperty.html) property, to effect other characteristics of the opened file. These characteristics include "record blocking" for read access, and "level checking" for file format verification. The value of **OpenAttributes** is an object of type [FileOpenAttr](dcsFileOpenAttrClass.html).

Record blocking can significantly improve sequential access efficiency, especially when utilized against a network database. If the value of [ FileOpenAttr.BlockingFactor](dcsFileOpenAttrClassBlockingFactorProperty.html) is set in the object referenced by **OpenAttributes** , then read-access record blocking will be used to access the opened file.

If the user provides a value to the [ FileOpenAttr.FormatIDs](dcsFileOpenAttrClassFormatIDsProperty.html) property of the object referenced by **OpenAttributes** , then the given format identifier(s) will be used to "level check" the format(s) of the file. If the file is not at the same level when the open operation occurs, the database will return an error.
Examples

<pre>        <span class="lang">
 **[C#]** 
        </span>
  /* Unlike OpenNewAdgDataSet, the Open method does not create
   * a new AdgDataSet to meet the requirements of the file being
   * opened. However, it is slightly faster because of this, so
   * Open is a preferable way to open a file if a suitable.
   * AdgDataSet already exists or you don't need one. 
   * Note, however, that opening a file is a relatively slow
   * operation and the need to reopen a file rarely occurs. */

  FileAdapter dbFile = new FileAdapter();
  dbFile.Connection = new AdgConnection("*Public/DG NET Local");
  dbFile.FileName = "*Libl/CMASTNEW";
  dbFile.MemberName = "CMMASTER";
  AdgDataSet myDS = null;

  /* Only need to open the file to show the number of records,
   * then we're through with it. */
  dbFile.Open(myDS); /* Will not initialize the data set. */

  MessageBox.Show("Number of deleted and non-deleted records still " +
      "taking up space in file \"" + dbFile.FileName +
      "\" is " + dbFile.FileLength.ToString());
  dbFile.Close();
  dbFile.Connection.Close();
</pre>
      <pre>        <span class="lang">
 **[Visual Basic]** 
        </span>
  ' Unlike OpenNewAdgDataSet, the Open method does not create
  ' a new AdgDataSet to meet the requirements of the file being
  ' opened. However, it is slightly faster because of this, so
  ' Open is a perrable way to open a file If a suitable.
  ' AdgDataSet already exists or you don't need one. 
  ' Note, however, that opening a file is a relatively slow
  ' operation and the need to reopen a file rarely occurs. 

  Dim dbFile As New FileAdapter
  dbFile.Connection = New AdgConnection("*Public/DG NET Local")
  dbFile.FileName = "*Libl/CMASTNEW"
  dbFile.MemberName = "CMMASTER"
  Dim myDS As AdgDataSet = Nothing

  ' Only need to open the file to show the number of records,
  ' then we're through with it. 
  dbFile.Open(myDS) ' Will not initialize the data set. 

  MsgBox("Number of deleted and non-deleted records still " &amp; _
      "taking up space in file """ &amp; dbFile.FileName &amp; _
      """ is " &amp; dbFile.FileLength.ToString())
  dbFile.Close()
  dbFile.Connection.Close()
</pre>

Requirements

**Namespace:** [ASNA.DataGate.Client](dcsDataGateClientNamespace.html) 

**Assembly:** ASNA DataGate Client

**Platforms:** Windows Server 2008 R2, Windows Server 2012, Windows 7, Windows 8 Pro, Windows 8.1 Pro, Windows 10
See Also

<dl />
      [FileAdapter Class](dcsFileAdapterClass.html)
      <br />
      [FileAdapter ClassMembers](dcsFileAdapterMembers.html)
      <br />
      [OpenNewAdgDataSet Method](dcsFileAdapterClassOpenNewAdgDataSetMethod.html)
      <br />
      [OpenSimpleQuery Method](dcsFileAdapterClassOpenSimpleQueryMethod.html)
      <br />
      [FileName Property](dcsFileAdapterClassFileNameProperty.html)
      <br />
      [MemberName Property](dcsFileAdapterClassMemberNameProperty.html)
      <br />
      [AccessMode Property](dcsFileAdapterClassAccessModeProperty.html)
      <br />
      [AdgConnection Class](dcsAdgConnectionClass.html)
      <br />
      [AdgDataSet Class](dcsAdgDataSetClass.html)
      <br />
      [FileOpenAttr Class](dcsFileOpenAttrClass.html)
      <br />
      [BlockingFactor Property](dcsFileOpenAttrClassBlockingFactorProperty.html)
      <br />
      [FormatIDs Property](dcsFileOpenAttrClassFormatIDsProperty.html)
      <br />
      [AccessMode Enumeration](dcsAccessModeEnumeration.html)
      <br />
      [ASNA.DataGate.Client Namespace](dcsDataGateClientNamespace.html)

